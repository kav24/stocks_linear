geom_point()
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.95, 1.05),
labels = seq(0.95, 1.05, by 0.01))+
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.95, 1.05),
labels = seq(0.95, 1.05, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.95, 1.05),
labels = seq(0.95, 1.05, by = 0.01),
breaks = seq(0.95, 1.05, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.05),
labels = seq(0.97, 1.05, by = 0.01),
breaks = seq(0.97, 1.05, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.08),
labels = seq(0.97, 1.08, by = 0.01),
breaks = seq(0.97, 1.08, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.08),
labels = seq(0.97, 1.08, by = 0.01),
breaks = seq(0.97, 1.08, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
scale_x_continuous(limits = c(0.93, 1.03),
labels = seq(0.93, 1.03, by = 0.01),
breaks = seq(0.93, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
scale_x_continuous(limits = c(0.99, 1.08),
labels = seq(0.99, 1.08, by = 0.01),
breaks = seq(0.99, 1.08, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
scale_x_continuous(limits = c(0.94, 1.02),
labels = seq(0.94, 1.02, by = 0.01),
breaks = seq(0.94, 1.02, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
scale_x_continuous(limits = c(0.99, 1.08),
labels = seq(0.99, 1.08, by = 0.01),
breaks = seq(0.99, 1.08, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
scale_x_continuous(limits = c(0.94, 1.01),
labels = seq(0.94, 1.01, by = 0.01),
breaks = seq(0.94, 1.01, by = 0.01))+
theme(aspect.ratio = 1)
View(stocks)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
scale_x_continuous(limits = c(0.99, 1.08),
labels = seq(0.99, 1.08, by = 0.01),
breaks = seq(0.99, 1.08, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
scale_x_continuous(limits = c(0.94, 1.01),
labels = seq(0.94, 1.01, by = 0.01),
breaks = seq(0.94, 1.01, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = volume)) +
geom_point() +
theme(aspect.ratio = 1)
ggplot(data = heart, mapping = aes(y = age, x = chd)) +
geom_boxplot() +
theme_bw() +
scale_y_continuous(limits = c(35, 60),
labels = seq(35, 60, by = 5),
breaks = seq(35, 60, by = 5),
minor_breaks = seq(35, 60, by = 5)) +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
scale_x_continuous(limits = c(0.99, 1.08),
labels = seq(0.99, 1.08, by = 0.01),
breaks = seq(0.99, 1.08, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
scale_x_continuous(limits = c(0.94, 1.01),
labels = seq(0.94, 1.01, by = 0.01),
breaks = seq(0.94, 1.01, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = volume)) +
geom_point() +
theme(aspect.ratio = 1)
ggplot(data = heart, mapping = aes(y = open, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
scale_x_continuous(limits = c(0.99, 1.08),
labels = seq(0.99, 1.08, by = 0.01),
breaks = seq(0.99, 1.08, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
scale_x_continuous(limits = c(0.94, 1.01),
labels = seq(0.94, 1.01, by = 0.01),
breaks = seq(0.94, 1.01, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = volume)) +
geom_point() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = open, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = low, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = high, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
scale_x_continuous(limits = c(0.99, 1.08),
labels = seq(0.99, 1.08, by = 0.01),
breaks = seq(0.99, 1.08, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
scale_x_continuous(limits = c(0.94, 1.01),
labels = seq(0.94, 1.01, by = 0.01),
breaks = seq(0.94, 1.01, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = volume)) +
geom_point() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = open, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = low, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = high, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
geom_jitter(height = 0.1) +  # this is what makes the jitter
# you can change the height argument to see how it affects the jittering
theme_bw() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
geom_jitter(height = 0.1) +  # this is what makes the jitter
# you can change the height argument to see how it affects the jittering
theme_bw() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
geom_jitter(height = 0.1) +  # this is what makes the jitter
# you can change the height argument to see how it affects the jittering
theme_bw() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = open, x = close)) +
geom_point() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = open, x = close)) +
geom_boxplot() +
theme(aspect.ratio = 1)+
coord_flip()
ggplot(data = stocks, mapping = aes(y = open, x = close, group=1)) +
geom_boxplot() +
theme(aspect.ratio = 1)+
coord_flip()
stocks <- read.csv("stock_data.csv", header=TRUE)
head(stocks)
summary(stocks)
stocks$close <- as.factor(stocks$close)
```{r}
ggplot(data = stocks, mapping = aes(y = open, x = close, group=1)) +
geom_boxplot() +
theme(aspect.ratio = 1)+
coord_flip()
ggplot(data = stocks, mapping = aes(y = open, x = close)) +
geom_boxplot() +
theme(aspect.ratio = 1)+
coord_flip()
ggplot(data = stocks, mapping = aes(y = open, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = low, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = high, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = open, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = low, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = high, x = close)) +
geom_boxplot() +
theme_bw() +
theme(aspect.ratio = 1) +
coord_flip()
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
geom_jitter(height = 0.1) +  # this is what makes the jitter
# you can change the height argument to see how it affects the jittering
theme_bw() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
geom_jitter(height = 0.1) +  # this is what makes the jitter
# you can change the height argument to see how it affects the jittering
theme_bw() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
geom_jitter(height = 0.1) +  # this is what makes the jitter
# you can change the height argument to see how it affects the jittering
theme_bw() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
scale_x_continuous(limits = c(0.97, 1.03),
labels = seq(0.97, 1.03, by = 0.01),
breaks = seq(0.97, 1.03, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
scale_x_continuous(limits = c(0.99, 1.08),
labels = seq(0.99, 1.08, by = 0.01),
breaks = seq(0.99, 1.08, by = 0.01))+
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
scale_x_continuous(limits = c(0.94, 1.01),
labels = seq(0.94, 1.01, by = 0.01),
breaks = seq(0.94, 1.01, by = 0.01))+
theme(aspect.ratio = 1)
library(corrplot)
ggplot(data = stocks, mapping = aes(y = close, x = open)) +
geom_point() +
geom_jitter(height = 0.1) +  # this is what makes the jitter
# you can change the height argument to see how it affects the jittering
theme_bw() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = high)) +
geom_point() +
geom_jitter(height = 0.1) +  # this is what makes the jitter
# you can change the height argument to see how it affects the jittering
theme_bw() +
theme(aspect.ratio = 1)
ggplot(data = stocks, mapping = aes(y = close, x = low)) +
geom_point() +
geom_jitter(height = 0.1) +  # this is what makes the jitter
# you can change the height argument to see how it affects the jittering
theme_bw() +
theme(aspect.ratio = 1)
corrplot(cor(stocks[, -7), type = "upper")
corrplot(cor(stocks[, -7]), type = "upper")
corrplot(cor(stocks[, -6]), type = "upper")
corrplot(cor(stocks[, 7]), type = "upper")
corrplot(cor(stocks[, -7]), type = "upper")
corrplot(cor(stocks[, -7]), type = "upper")
corrplot(cor(stocks[, 7]), type = "upper")
corrplot(cor(stocks[, -7]), type = "upper")
sapply(stocks.data, typeof)
sapply(stocks, typeof)
corrplot(cor(stocks[, -7]), type = "upper")
sapply(stocks, typeof)
corrplot(cor(stocks[3:6, 7]), type = "upper")
sapply(stocks, typeof)
corrplot(cor(stocks[3:6, -7]), type = "upper")
sapply(stocks, typeof)
temp <- stocks[:,3:7]
sapply(stocks, typeof)
temp <- stocks[,3:7]
corrplot(cor(stocks[3:6, -7]), type = "upper")
View(temp)
sapply(stocks, typeof)
temp <- stocks[,3:7]
corrplot(cor(temp[, -4]), type = "upper")
sapply(stocks, typeof)
temp <- stocks[,3:7]
corrplot(cor(temp[, -5]), type = "upper")
stocks.best.subset.bic <-bestglm(temp,
IC = "BIC",
method = "exhaustive",
TopModels = 1,
family = binomial)
library(bestglm)
stocks.best.subset.bic <-bestglm(temp,
IC = "BIC",
method = "exhaustive",
TopModels = 1,
family = binomial)
summary(stocks.best.subset.bic$BestModel)
stocks.logistic <- glm(data = stocks, close ~ open +  close,
family = binomial(link= "logit"))
summary(dia.logistic)
stocks.logistic <- glm(data = stocks, close ~ open +  close,
family = binomial(link= "logit"))
summary(stocks.logistic)
stocks.logistic <- glm(data = stocks, close ~ high +  low,
family = binomial(link= "logit"))
summary(stocks.logistic)
scatter.smooth(x = stocks$high, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "High", ylab = "Close")
scatter.smooth(x = stocks$high, y = stocks$close - 1,
pch = 19, xlab = "High", ylab = "Close")
scatter.smooth(x = stocks$high, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "High", ylab = "Close")
scatter.smooth(x = stocks$high, y = as.numeric(stocks$close) - 1,
pch = 10, xlab = "High", ylab = "Close")
scatter.smooth(x = stocks$high, y = stocks$close - 1,
pch = 10, xlab = "High", ylab = "Close")
scatter.smooth(x = stocks$high, y = stocks$close - 1,
pch = 10, xlab = "High", ylab = "Close")
stocks.logistic <- glm(data = stocks, close ~ high +  low,
family = binomial(link= "logit"))
summary(stocks.logistic)
scatter.smooth(x = stocks$high, y = as.numeric(stocks$close) - 1,
pch = 10, xlab = "High", ylab = "Close")
scatter.smooth(x = stocks$low, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = stocks$low, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = stocks$high, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = stocks$low, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = as.numeric(stocks$high), y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = stocks$low, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = stocks$high, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = stocks$low, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = stocks$volume, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = stocks$low, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = stocks$open, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
scatter.smooth(x = stocks$high, y = as.numeric(stocks$close) - 1,
pch = 19, xlab = "Low", ylab = "Close")
sapply(stocks, typeof)
temp <- stocks[,3:7]
corrplot(cor(temp[, -5]), type = "upper")
library(corrplot)
sapply(stocks, typeof)
temp <- stocks[,3:7]
corrplot(cor(temp[, -5]), type = "upper")
stocks.dffits <- data.frame("dffits" = dffits(stocks.logistic))
stocks.dffits$obs <- 1:length(stocks$close)
ggplot(data = stocks.dffits) +
geom_point(mapping = aes(x = obs, y = abs(dffits))) +
geom_hline(mapping = aes(yintercept = 1),
color = "red", linetype = "dashed") +
theme_bw() +
theme(aspect.ratio = 1)
library(tidyverse)
library(corrplot)
library(bestglm)
stocks.dffits <- data.frame("dffits" = dffits(stocks.logistic))
stocks.dffits$obs <- 1:length(stocks$close)
ggplot(data = stocks.dffits) +
geom_point(mapping = aes(x = obs, y = abs(dffits))) +
geom_hline(mapping = aes(yintercept = 1),
color = "red", linetype = "dashed") +
theme_bw() +
theme(aspect.ratio = 1)
stocks.dffits[abs(stocks.dffits$dffits) >1,]
theme(aspect.ratio = 1)
stocks.dffits[abs(stocks.dffits$dffits) >1,]
stocks.dffits <- data.frame("dffits" = dffits(stocks.logistic))
stocks.dffits$obs <- 1:length(stocks$close)
ggplot(data = stocks.dffits) +
geom_point(mapping = aes(x = obs, y = abs(dffits))) +
geom_hline(mapping = aes(yintercept = 1),
color = "red", linetype = "dashed") +
theme_bw() +
theme(aspect.ratio = 1)
stocks.dffits[abs(stocks.dffits$dffits) >1,]
stocks.vifs <- vif(stocks.logistic)
library(car)
library(ROCR)
library(pROC)
stocks.vifs <- vif(stocks.logistic)
stocks.vifs
mean(stocks.vifs)
like.ratio <- stock.logistic$null.deviance - stock.logistic$deviance
like.ratio <- stocks.logistic$null.deviance - stocks.logistic$deviance
like.ratio
pchisq(like.ratio, 4, lower.tail = FALSE)
